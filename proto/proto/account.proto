syntax = "proto3";
package proto;

import "proto/base.proto";

message PUser {
    int32 id = 1; // 用户id
    string name = 2; // 用户名/昵称
    string phone = 3; // 手机号
    string email = 4; // 邮箱
    int32 gender = 5; // 性别: 0未设置,1男,2女
    int32 school_id = 6; // 学校id
    int32 class_id = 7; // 班级id
    int32 area_id = 8; // 区域id
    int32 identity_status = 9; // 区域id
    int32 created = 10; // 注册时间
}

// 登陆方式
enum ELoginType {
    ACCOUNT = 0; // 账号
    PHONE = 1; // 手机号
    WECHAT = 2; // 微信
    QQ = 3; // qq
}

// 登陆方式
enum Os {
    ANDROID = 0; // 账号
    IOS = 1; // 手机号
    WEB = 2; // 微信
}

// 用户及jwt token信息
// 登陆及注册下使用
message PUserAndToken {
    PUser user = 1; // 用户信息
    string token = 2; // jwt token信息
}

// 登陆所需结构
message PLoginData {
    string phone = 1; // 手机号
    string verify_code = 2; // 验证码
    string account = 3; // 账号
    string password = 4; // 密码 todo 加密问题
    ELoginType login_type = 5; // 登陆方式
    Os os = 6;
}

// 登陆所需结构
message PRegData {
    string phone = 1; // 手机号
    string verify_code = 2; // 验证码
    string account = 3; // 账号
    string password = 4; // 密码 todo 加密问题
}

// 用户已绑定的登录方式信息
message PLoignBindInfo {
    string Account = 1; // 用户名，没有则为空
    string Phone = 2; // 手机号码，没有则为空
    bool Wechat = 3; // 是否已绑定微信，绑定为true，未绑定为false
    bool QQ = 7; // 是否已绑定QQ，绑定为true，未绑定为false
    bool WeiBo = 4; // 是否已绑定微博，绑定为true，未绑定为false
}

message PLoignBindInfoList {
    repeated PLoignBindInfo List = 1;
}

service Account {
    // 登陆(账号或手机号)
    rpc Login (PLoginData) returns (PUserAndToken) {
    }
    // 注册信息
    rpc Reg (PString) returns (PUserAndToken) {
    }
    // 获取验证码
    rpc GetVerifyCode (PString) returns (PBool) {
    }
    // 获取账号信息
    rpc GetAccountInfo (PInt32) returns (PUser) {
    }
}

